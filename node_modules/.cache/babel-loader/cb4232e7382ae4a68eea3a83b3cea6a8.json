{"remainingRequest":"/home/joel/Projetos/Web/sigadm-web/node_modules/babel-loader/lib/index.js!/home/joel/Projetos/Web/sigadm-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/joel/Projetos/Web/sigadm-web/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/joel/Projetos/Web/sigadm-web/src/pages/Modulos/Patrimonio/Instrumento/Devolucao/DevolucaoModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/joel/Projetos/Web/sigadm-web/src/pages/Modulos/Patrimonio/Instrumento/Devolucao/DevolucaoModal.vue","mtime":1577190729764},{"path":"/home/joel/Projetos/Web/sigadm-web/node_modules/cache-loader/dist/cjs.js","mtime":1569691702388},{"path":"/home/joel/Projetos/Web/sigadm-web/node_modules/babel-loader/lib/index.js","mtime":1569691629983},{"path":"/home/joel/Projetos/Web/sigadm-web/node_modules/cache-loader/dist/cjs.js","mtime":1569691702388},{"path":"/home/joel/Projetos/Web/sigadm-web/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1569691710961}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport _slicedToArray from \"/home/joel/Projetos/Web/sigadm-web/node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport swal from \"sweetalert2\";\nexport default {\n  data: function data() {\n    return {\n      dialog: false,\n      dialog_devolucao: false,\n      data_devolucao: new Date().toISOString().substr(0, 10),\n      modal: false,\n      emprestimos: [],\n      id_emprestimo: 0,\n      observacao: \"\"\n    };\n  },\n  computed: {\n    computedDateFormatted: function computedDateFormatted() {\n      return this.formatDate(this.data_devolucao);\n    }\n  },\n  watch: {\n    date: function date(val) {\n      this.dateFormatted = this.formatDate(this.data_devolucao);\n    }\n  },\n  props: [\"numero_do_tombamento_devolucao\", \"numero_do_instrumento_devolucao\"],\n  methods: {\n    CadastrarDevolucao: function CadastrarDevolucao() {\n      var _this = this;\n\n      ////console.log(\"cadastrar devolução\");\n      var autorizacaoAux = sessionStorage.getItem(\"usuario\");\n      var id_emprestimo_buscado;\n\n      if (!autorizacaoAux) {\n        swal.fire(\"Sua autorização expirou!\", \"Entre com suas credencias novamente.\", \"warning\");\n        this.$router.push(\"/\");\n      }\n\n      if (autorizacaoAux) {\n        //console.log(\"cadastrar devolução buscando\");\n        this.autorizacao = JSON.parse(autorizacaoAux); ////console.log(\"entrou no cadastro de devolucao\");\n\n        this.$http.get(this.$url + \"EmprestimoInstrumento/v1/buscar-emprestimo?tombamento=\" + this.numero_do_tombamento_devolucao, {\n          headers: {\n            authorization: \"Bearer \" + this.autorizacao.accessToken\n          }\n        }).then(function (response) {\n          if (response.status == 200) {\n            _this.emprestimos = response.data;\n\n            _this.Loading(\"Realizando devolução...\", \"hourglass-half\"); ////console.log(this.emprestimos);\n\n\n            _this.emprestimos.forEach(function (element) {\n              ////console.log(\"status: \", element.id);\n              id_emprestimo_buscado = element.id; ////console.log(id_emprestimo_buscado);\n\n              if (element.status == 2) //console.log(\"cadastrar devolução\");                \n                _this.$http.post(_this.$url + \"DevolucaoInstrumento/v1\", {\n                  id: 0,\n                  idInstrumento: _this.numero_do_instrumento_devolucao,\n                  idEmprestimo: id_emprestimo_buscado,\n                  tombamento: _this.numero_do_tombamento_devolucao,\n                  status: \"1\",\n                  devolucaoDate: _this.data_devolucao,\n                  observacao: _this.observacao,\n                  launchDate: new Date().toISOString().substr(0, 19)\n                }, {\n                  headers: {\n                    authorization: \"Bearer \" + _this.autorizacao.accessToken\n                  }\n                }).then(function (response) {\n                  if (response.status == 200) {\n                    // //console.log(\"data value emprestimo\", response.data);                     \n                    _this.$emit(\"devolucao_atualizar\");\n                  }\n                }).catch(function (e) {\n                  swal.fire(\"Sua autorização expirou!\", \"Entre com suas credencias novamente.\", \"warning\");\n\n                  _this.$router.push(\"/\"); //console.error(e);\n                  //console.data(e.data);\n                  //console.log(\"status\", e.data.status);\n\n                });\n            });\n          }\n        }).catch(function (e) {\n          swal.fire(\"Sua autorização expirou!\", \"Entre com suas credencias novamente.\", \"warning\");\n\n          _this.$router.push(\"/\"); //console.log(\"Erro no emprestimo\");\n          //console.error(e);\n          //console.data(e.data);\n\n        });\n      }\n    },\n    Loading: function Loading(title, icon) {\n      swal.fire({\n        title: title,\n        html: \"Por favor só um momento... \" + '<i class=\"fas fa-' + icon + '></i>',\n        timer: 3000,\n        onOpen: function onOpen() {\n          swal.enableLoading();\n        }\n      });\n    },\n    Salvo: function Salvo(title, msg, type) {\n      swal.fire(title, msg, type);\n    },\n    formatDate: function formatDate(date) {\n      if (!date) return null;\n\n      var _date$split = date.split(\"-\"),\n          _date$split2 = _slicedToArray(_date$split, 3),\n          year = _date$split2[0],\n          month = _date$split2[1],\n          day = _date$split2[2];\n\n      return \"\".concat(day, \"/\").concat(month, \"/\").concat(year);\n    }\n  }\n};",{"version":3,"sources":["DevolucaoModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <v-layout row justify-left class=\"\">\n    <v-dialog v-model=\"dialog\" persistent max-width=\"600px\">\n      <v-btn slot=\"activator\" flat color=\"red\" class=\"align-left\">\n        <small>DEVOLVER</small>\n      </v-btn>\n      <v-card>\n        <v-flex xs12 sm12>\n          <div class=\"pt-3\">\n            <v-btn\n              right\n              class=\"white--text\"\n              small\n              fab\n              round\n              outline\n              color=\"red darken-1\"\n              absolute\n              v-on:click=\"dialog = false\"\n            >\n              <v-icon>close</v-icon>\n            </v-btn>\n          </div>\n        </v-flex>\n        <v-card-title>\n          <v-flex xs12 sm12 md12 lg12 align-center>\n            <span class=\"headline teal--text text--darken-3\">Devolução</span>\n          </v-flex>\n        </v-card-title>\n        <v-card-text>\n          <v-container grid-list-md>\n            <v-layout wrap>\n              <v-flex xs12 sm12 md12>\n                <v-dialog\n                  ref=\"dialog_devolucao\"\n                  v-model=\"modal\"\n                  :return-value.sync=\"data_devolucao\"\n                  persistent\n                  lazy\n                  full-width\n                  width=\"290px\"\n                >\n                  <v-text-field\n                    slot=\"activator\"\n                    v-model=\"computedDateFormatted\"\n                    label=\"Data da Devolução *\"\n                    append-icon=\"event\"\n                    readonly\n                    hint\n                    persistent-hint\n                    outline\n                  ></v-text-field>\n                  <v-date-picker v-model=\"data_devolucao\" scrollable locale=\"pt-BR\">\n                    <v-spacer></v-spacer>\n                    <v-btn flat color=\"primary\" @click=\"modal = false\">Cancelar</v-btn>\n                    <v-btn\n                      flat\n                      color=\"primary\"\n                      @click=\"$refs.dialog_devolucao.save(data_devolucao)\"\n                    >OK</v-btn>\n                  </v-date-picker>\n                </v-dialog>\n              </v-flex>\n              <v-flex xs12 sm12 md12>\n                <v-text-field\n                  v-model=\"observacao\"\n                  outline\n                  color=\"teal darken-3\"\n                  append-icon=\"fas fa-eye\"\n                  label=\"Observação\"\n                  required\n                ></v-text-field>\n              </v-flex>\n              <v-flex xs12 sm12 md12 lg12 align-center>\n                <small>*campos com asterisco (*) são obrigatórios.</small>\n              </v-flex>\n            </v-layout>\n          </v-container>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-flex xs12 sm12 md12 lg12 align-center>\n            <v-btn\n              color=\"teal darken-2\"\n              round\n              center\n              outline\n              v-on:click=\"CadastrarDevolucao()\"\n              @click=\"dialog = false\"\n            >DEVOLVER</v-btn>\n          </v-flex>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </v-layout>\n</template>\n<script>\nimport swal from \"sweetalert2\";\n\nexport default {\n  data() {\n    return {\n      dialog: false,\n      dialog_devolucao: false,\n      data_devolucao: new Date().toISOString().substr(0, 10),\n      modal: false,\n      emprestimos: [],\n      id_emprestimo: 0,\n      observacao: \"\"\n    };\n  },\n  computed: {\n    computedDateFormatted() {\n      return this.formatDate(this.data_devolucao);\n    }\n  },\n  watch: {\n    date(val) {\n      this.dateFormatted = this.formatDate(this.data_devolucao);\n    }\n  },\n  props: [\"numero_do_tombamento_devolucao\", \"numero_do_instrumento_devolucao\"],\n  methods: {    \n    CadastrarDevolucao() {\n      ////console.log(\"cadastrar devolução\");\n      let autorizacaoAux = sessionStorage.getItem(\"usuario\");\n      var id_emprestimo_buscado;\n      if (!autorizacaoAux) {\n        swal.fire(\n          \"Sua autorização expirou!\",\n          \"Entre com suas credencias novamente.\",\n          \"warning\"\n        );\n        this.$router.push(\"/\");\n      }\n      if (autorizacaoAux) {\n        //console.log(\"cadastrar devolução buscando\");\n        this.autorizacao = JSON.parse(autorizacaoAux);\n        ////console.log(\"entrou no cadastro de devolucao\");\n        this.$http\n          .get(\n            this.$url +\n              \"EmprestimoInstrumento/v1/buscar-emprestimo?tombamento=\" +\n              this.numero_do_tombamento_devolucao,\n            {\n              headers: {\n                authorization: \"Bearer \" + this.autorizacao.accessToken\n              }\n            }\n          )\n          .then(response => {\n            if (response.status == 200) {\n              this.emprestimos = response.data;\n              this.Loading(\"Realizando devolução...\",\"hourglass-half\")              \n              ////console.log(this.emprestimos);\n              this.emprestimos.forEach(element => {\n                ////console.log(\"status: \", element.id);\n                id_emprestimo_buscado = element.id;\n                ////console.log(id_emprestimo_buscado);\n                if (element.status == 2) //console.log(\"cadastrar devolução\");                \n                this.$http\n                  .post(\n                    this.$url + \"DevolucaoInstrumento/v1\",\n                    {\n                      id: 0,\n                      idInstrumento: this.numero_do_instrumento_devolucao,\n                      idEmprestimo: id_emprestimo_buscado,\n                      tombamento: this.numero_do_tombamento_devolucao,\n                      status: \"1\",\n                      devolucaoDate: this.data_devolucao,\n                      observacao: this.observacao,\n                      launchDate: new Date().toISOString().substr(0, 19)\n                    },\n                    {\n                      headers: {\n                        authorization: \"Bearer \" + this.autorizacao.accessToken\n                      }\n                    }\n                  )\n                  .then(response => {\n                    if (response.status == 200) {\n                      // //console.log(\"data value emprestimo\", response.data);                     \n                      this.$emit(\"devolucao_atualizar\");\n                    }\n                  })\n                  .catch(e => {\n                    swal.fire(\n                      \"Sua autorização expirou!\",\n                      \"Entre com suas credencias novamente.\",\n                      \"warning\"\n                    );\n                    this.$router.push(\"/\");\n                    //console.error(e);\n                    //console.data(e.data);\n                    //console.log(\"status\", e.data.status);\n                  });\n              });\n            }\n          })\n          .catch(e => {\n            swal.fire(\n              \"Sua autorização expirou!\",\n              \"Entre com suas credencias novamente.\",\n              \"warning\"\n            );\n            this.$router.push(\"/\");\n            //console.log(\"Erro no emprestimo\");\n            //console.error(e);\n            //console.data(e.data);\n          });\n      }\n    },\n    Loading(title,icon) {\n      swal.fire({\n        title: title,\n        html:\n          \"Por favor só um momento... \" +\n          '<i class=\"fas fa-'+icon+'></i>',\n        timer: 3000,\n        onOpen: () => {\n          swal.enableLoading();\n        }\n      });\n    },\n    Salvo(title,msg,type) {\n      swal.fire(title, msg,type);\n    },\n    formatDate(date) {\n      if (!date) return null;\n\n      const [year, month, day] = date.split(\"-\");\n      return `${day}/${month}/${year}`;\n    }\n  }\n};\n</script>\n<style>\n.mesmo-tamanho {\n  width: 100%;\n  white-space: normal;\n}\n</style>\n"],"sourceRoot":"src/pages/Modulos/Patrimonio/Instrumento/Devolucao"}]}